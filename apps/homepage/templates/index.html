<!DOCTYPE html>
<html lang='en'>
	<head>
		<title>Maitre 'Clik - Desktop</title>
        
        <!-- Blueprint CSS -->
        <link rel="stylesheet" href="/static/css/blueprint/screen.css" type="text/css" media="screen, projection" />
        <link rel="stylesheet" href="/static/css/blueprint/print.css" type="text/css" media="print" />
        <!--[if IE]><link rel="stylesheet" href="blueprint/ie.css" type="text/css" media="screen, projection" /><![endif]-->

        <!-- CSS -->
		<link rel="stylesheet" href="/static/css/styles.css">
		<link rel="stylesheet" href="/static/css/webticker.css">
    </head>

    <body>
        <div id='wrap'>
            <div id='main' class='container'>
                <div class="span-24 append-bottom last">
                    <div id="audio"></div>
                    <div id="qrContainer"></div>

                    <!-- Main View -->
                    <div class="span-16 last" id="mainView">
                        <div class="span-8">
                            <img src="/static/imgs/waiter.jpg" />
                        </div>

                        <h1 class="title">Bonjour</h1>

                        <ul id="mainView_webticker">
                        </ul>
                            
                        <button id="mainView_showStatsView">Stats</button>
                    </div>

                    <!-- Stats View -->
                    <div class="span-16 last" id="statsView" style="display: none">
                        <h1 class="title">Stats</h1>
                        
                        <button id="statsView_showMainView">Back</button>
                    </div>


                </div>
            </div>
        </div>
        
        <!-- JS -->
		<script type="text/javascript" src="http://code.jquery.com/jquery-1.7.1.min.js"></script>
		<script type="text/javascript" src="http://v2.clikthis.com/js/latest/clik-mobile.min.js"></script>
		<script type="text/javascript" src="/static/js/speakClient.js"></script>
        <script type="text/javascript" src="/static/js/jquery.webticker.js"></script>


        <script>
            var MaitreDesktop = new function() {

                this.mainView  = $("#mainView");
                this.statsView = $("#statsView");
                this.ticker    = $("#mainView_webticker");

                this.init = function( ) {

                    // Init Views
                    //this.ticker.webTicker();

                    $("#mainView_showStatsView").click( function() { MaitreDesktop.showStatsView(); } );
                    $("#statsView_showMainView").click( function() { MaitreDesktop.showMainView(); } );

                    clik.on('connect', function () {
                        var li = "<li>Hello World!</li>";
                        $("#mainView_webticker").append( li );
                    });

                    clik.on('checkin', function ( user ) {
                        alert('name: ' + user.name );
                        welcome( user.name );
                        
                        var li = "<li>" + user.name.split(' ')[0] + " is eating.</li>";
                        $("#mainView_webticker").append( li );
                    });

                    clik.on('vote', function ( msg ) {
                        var li = "<li>" + msg.name.split(' ')[0] + " voted! " + msg.value + "/10!!</li>";
                        $("#mainView_webticker").append( li );
                    });

                    // A user has left the conference
                    clik.on('leave', function () {
                        var li = "<li>Someone has left the building.</li>";
                        $("#mainView_webticker").append( li );
                    });
                };

                this.run = function( ) {
                    speak("Bonne Joooure. Juh map elle Fran swa", {wordgap:5} );
                    
                    // When Clik is ready to serve events..
                    clik.ready(function () {
                        // Populate ClikCode
                        $("#qrContainer").css('background-image', 'url(' + clik.clikCodeURL() + ')');
        
                    });
                };

                // View Toggles ------------------------------------------------
                this.showStatsView = function() {
                    this.mainView.hide();
                    this.statsView.fadeIn();
                };
                this.showMainView = function() {
                    this.statsView.hide();
                    this.mainView.fadeIn();
                };

            };

            MaitreDesktop.init();
            MaitreDesktop.run();

            var welcome = function( name ) {
                var date = new Date();

                // If dinner time,
                if( date.getHours() >= 16 ) { 
                    speak( "Bonne Swar" + name, {wordgap:5} );

                } else { // If lunch time
                    speak( "Bonne Jooooure" + name, {wordgap:5} );
                }
            };

        </script>
    </body>
</html>
