{% extends 'base.html' %}

{% block content %}
        <div id="audio"></div>
        <div id="qrContainer"></div>

        <div class="span-8">
            <img src="/static/imgs/waiter.jpg" />

            <a href="{% url ShowStats %}">Stats</a>
        </div>

		<div class="span-16 last" id="mainView">
            <h1 id="title">Bonjour</h1>
        </div>
		<div class="span-16 last" id="statsView" style="display: none">
            <h1 id="title">Stats</h1>
        </div>

{% endblock content %}

{% block javascript %}
		<script src="/static/js/speakClient.js"></script>

        <script>
            var MaitreDesktop = new function() {
                this.init = function( ) {
                    // Populate with current users when connection established
                    clik.on('connect', function () {
                        return;
                    });

                    // A user has joined the conference
                    clik.on('checkin', function ( name, uuid ) {
                        welcome( name );
                    });
                    clik.on('vote', function ( name, uuid, value ) {
                        alert( name + " " + uuid + " " + value );
                    });

                    // A user has left the conference
                    clik.on('leave', function () {
                        // Update view
                        return;
                    });
                };

                this.run = function( ) {

                    speak("Bonne Joooure. Juh map elle Fran swa", {wordgap:5} );
                    
                    // When Clik is ready to serve events..
                    clik.ready(function () {
                        // Populate ClikCode
                        $("#qrContainer").css('background-image', 'url(' + clik.clikCodeURL() + ')');
                    });
                };

                this.welcome = function( name ) {
                    var date = new Date();

                    // If dinner time,
                    if( date.getHours() >= 16 ) { 
                        speak( "Bonne Swar" + name, {wordgap:5} );

                    } else { // If lunch time
                        speak( "Bonne Jooooure" + name, {wordgap:5 } );
                    }
                };

                // Maintain a graphical version of the participant list.
                function renderClientList () {
                    var $parts = $('#parts');

                    $parts.html('');

                    $.each(clik.clients, function (i, client) {
                        $parts.append(
                            '<li id="'+client.id+'">' + client.id + '</li>'
                        );
                    });
                };
            };

            MaitreDesktop.init();
            MaitreDesktop.run();
        </script>

{% endblock javascript %}
