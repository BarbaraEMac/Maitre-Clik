{% extends 'base.html' %}

{% block content %}
        <div id="qrContainer"></div>

        <div class="span-8">
            <img src="/static/imgs/waiter.jpg" />

            <a href="{% url ShowDesktopPage %}">Back</a>
        </div>

        <h1>Stats</h1>
{% endblock content %}

{% block javascript %}
		<script src="/static/js/speakClient.js"></script>
        
        <script>

            var welcome = function( name ) {
                speak( "Bonjour " + name );
            };
    
			// When Clik is ready to serve events..
			clik.ready(function () {
				// Populate ClikCode
				$("#qrContainer").css('background-image', 'url(' + clik.clikCodeURL() + ')');

				// Populate conference ID
				$("#conferenceId").val( clik.id );

				// Populate your user ID
				$("#participantId").val( clik.client.id );
			});

			// Maintain a graphical version of the participant list.
			function renderClientList () {
				var $parts = $('#parts');

				$parts.html('');

				$.each(clik.clients, function (i, client) {
					$parts.append(
						'<li id="'+client.id+'">' + client.id + '</li>'
					);
				});
			}

			// Send a message
			function sendMessage (message) {
				var time        = new Date(),
					timeString  = time.toTimeString().split(' ')[0],
					chatMessage = {
						message : message,
						time    : timeString
					};

				// Send message to everyone else
				clik.send('chat', chatMessage);

				// Send message to yourself
				clik.trigger('chat', chatMessage, clik.client);
			}

			// Populate with current users when connection established
			clik.on('connect', function () {
			    speak("HELLLLLLO");
            });

			// A user has joined the conference
			clik.on('join', function () {
                welcome( 'Barbara' );

			});

			// A user has left the conference
			clik.on('leave', function () {
			    // Update view
                return;
            });

			// Receive chat messages and print them to the screen
			clik.on('chat', function (chatMsg) {
				$('#messageLog').prepend(
					'(' + chatMsg.time + ') ' + this.id + ': ' + chatMsg.message + '<hr>'
				);
			});
		</script>

{% endblock javascript %}
